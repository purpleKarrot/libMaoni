# Copyright (c) 2009 Daniel Pfeifer, University of Zurich

cmake_minimum_required(VERSION 2.8 FATAL_ERROR)
project(Maoni)

set(CMAKE_BUILD_TYPE Debug)
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin)

if(MSVC)
  add_definitions(/D_CRT_SECURE_NO_WARNINGS /WX)
else(MSVC)
  set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -Werror")
# set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -fPIC")
# set(CMAKE_C_FLAGS   "${CMAKE_C_FLAGS}   -fPIC")
endif(MSVC)

set(CTOOLBOX_USE_FILE ${CMAKE_BINARY_DIR}/UseCToolBox.cmake)
file(DOWNLOAD
  http://github.com/purpleKarrot/CToolBox/raw/master/UseCToolBox.cmake
  ${CTOOLBOX_USE_FILE})
include(${CTOOLBOX_USE_FILE})

list(APPEND CMAKE_MODULE_PATH ${CMAKE_SOURCE_DIR}/CMake)

include(Extract)
extract(${CMAKE_SOURCE_DIR}/include/boost-la.zip ${CMAKE_BINARY_DIR}/include)

if(WIN32)
  set(QGLVIEWER_DIR ${CMAKE_BINARY_DIR}/QGLViewer)
  extract(${CMAKE_SOURCE_DIR}/win32/QGLViewer.zip ${QGLVIEWER_DIR})
  set(QGLVIEWER_INCLUDE_DIR ${QGLVIEWER_DIR}/include)
  set(QGLVIEWER_LIBRARY     ${QGLVIEWER_DIR}/lib/QGLViewer2.lib)
endif(WIN32)


include_directories(include ${CMAKE_BINARY_DIR}/include)
install(DIRECTORY include/ DESTINATION include COMPONENT headers)

add_subdirectory(src)
add_subdirectory(examples)


set(THIS_PROJECT_NAME libMaoni)
include(AddReference)
include(AddDocumentation)
add_subdirectory(doc EXCLUDE_FROM_ALL)


set(CPACK_PACKAGE_NAME "Maoni")
set(CPACK_PACKAGE_VENDOR "http://github.com/purpleKarrot/libMaoni")
set(CPACK_PACKAGE_CONTACT Daniel Pfeifer)
set(CPACK_PACKAGE_DESCRIPTION_SUMMARY "common viewing framework")
set(CPACK_PACKAGE_VERSION "0.8.15")
set(CPACK_PACKAGE_VERSION_MAJOR "0")
set(CPACK_PACKAGE_VERSION_MINOR "8")
set(CPACK_PACKAGE_VERSION_PATCH "15")
set(CPACK_PACKAGE_INSTALL_DIRECTORY "Maoni")

set(CPACK_RESOURCE_FILE_LICENSE ${CMAKE_SOURCE_DIR}/COPYING)

set(CPACK_COMPONENTS_ALL headers devlibs runlibs)

set(CPACK_COMPONENT_HEADERS_DISPLAY_NAME "C++ Headers")
set(CPACK_COMPONENT_HEADERS_DESCRIPTION
  "C++ header files for use with Maoni")

set(CPACK_COMPONENT_DEVLIBS_DISPLAY_NAME "Developer Libraries")
set(CPACK_COMPONENT_DEVLIBS_DESCRIPTION
  "Libraries used to build programs with Maoni")

set(CPACK_COMPONENT_RUNLIBS_DISPLAY_NAME "Runtime Libraries")
set(CPACK_COMPONENT_RUNLIBS_DESCRIPTION
  "Libraries used to run Maoni based programs")

set(CPACK_NSIS_MUI_ICON "${CMAKE_SOURCE_DIR}/src/Icons/stanford-bunny.ico")

#todo: http://www.itk.org/Wiki/CMake:Component_Install_With_CPack

include(CPack)
